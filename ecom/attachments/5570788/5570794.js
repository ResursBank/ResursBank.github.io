/*!
 * OmniJS v0.01
 *
 * Generic iFrame-driver for Resurs Bank OmniCheckout, for catching events in the Omnicheckout iFrame.
 *
 */
;if(typeof ResursOmni!=="function"&&typeof ResursOmni==="undefined"){function ResursOmni(){var e="";var b="";var i;var c={paymentMethod:"",customerData:{}};var a=false;if(typeof arguments[0]!=="undefined"){e=arguments[0]}else{e="#omni-checkout-container"}var g="";if(typeof OMNICHECKOUT_IFRAME_URL!=="undefined"){g=OMNICHECKOUT_IFRAME_URL}var f=function(j){if(typeof j==="function"){return true}};var h=function(k){var j;b=document.getElementsByTagName("iframe")[0];j=b.contentWindow||b.contentDocument;if(j&&typeof g==="string"&&g!==""){j.postMessage(JSON.stringify(k),g)}};var d={setBookingCallback:function(j){i=j},setDebug:function(j){a=j;console.log("OmniJS verbosity level raised")},confirmOrder:function(j){if(typeof j!=="boolean"){j=false}if(a){console.log("OmniJS - Confirm order with boolean: "+j)}h({eventType:"omnicheckout:booking-order",isOrderReady:j})},postFrame:function(j){if(typeof j==="object"){if(a){console.log("OmniJS - Sending message to iframe: "+JSON.stringify(j))}h(j)}},init:function(){window.addEventListener("message",function(){var l=event.origin||event.originalEvent.origin;if(l!==g||typeof event.data!=="string"){return}var j=event.data;var k={};try{k=JSON.parse(j)}catch(m){return}if(k.hasOwnProperty("eventType")&&typeof k.eventType==="string"){switch(k.eventType){case"omnicheckout:loaded":h({eventType:"omnicheckout:set-booking-rule",checkOrderBeforeBooking:true});break;default:if(k.eventType.indexOf("omnicheckout")>-1){if(k.eventType=="omnicheckout:payment-method-change"){if(a){console.log("OmniJS - payment-method-change")}c.paymentMethod=k.method}else{if(k.eventType=="omnicheckout:user-info-change"){if(a){console.log("OmniJS - user-info-change")}c.customerData={address:(typeof k.address!=="undefined"?k.address:{}),delivery:(typeof k.delivery!=="undefined"?k.delivery:{}),ssn:k.ssn}}else{if(k.eventType=="omnicheckout:booking-order"){if(typeof i==="function"){if(a){console.log("OmniJS - booking-order event received, user defined callback is used.")}i(c,k)}else{if(typeof omniBookEvent==="function"){if(a){console.log("booking-order event received, default callback is used.")}omniBookEvent(c,k)}else{if(a){console.log("OmniJS - booking-order event received and not callbacks was found. Automatically confirming.")}h({eventType:"omnicheckout:booking-order",isOrderReady:true})}}}}}}}}},false)}};return d}};