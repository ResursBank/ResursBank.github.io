/*! OmniJS v0.04 - Generic iFrame-driver for Resurs Bank OmniCheckout, for catching events in the Omnicheckout iFrame */
;if(typeof ResursOmni!=="function"&&typeof ResursOmni==="undefined"){function ResursOmni(){var g="";var b="";var c="0.04";var d={paymentMethod:"",customerData:{}};var a=false;var k=null;var e=null;if(typeof arguments[0]!=="undefined"){g=arguments[0]}else{g="#omni-checkout-container"}var i="";if(typeof OMNICHECKOUT_IFRAME_URL!=="undefined"){i=OMNICHECKOUT_IFRAME_URL}var h=function(l){if(typeof l==="function"){return true}};var j=function(m){var l;b=document.getElementsByTagName("iframe")[0];l=b.contentWindow||b.contentDocument;if(l&&typeof i==="string"&&i!==""){l.postMessage(JSON.stringify(m),i)}};var f={setBookingCallback:function(l){k=l},setPurchaseFailCallback:function(l){e=l},setDebug:function(l){if(l==1){l=true}a=l;console.log("OmniJS verbosity level raised")},confirmOrder:function(l){if(typeof l!=="boolean"){l=false}if(a){console.log("OmniJS - Confirm order with boolean: "+l)}j({eventType:"omnicheckout:order-status",orderReady:l})},postFrame:function(l){if(typeof l==="object"){if(a){console.log("OmniJS - Sending message to iframe: "+JSON.stringify(l))}j(l)}},init:function(){window.addEventListener("message",function(o){var n=o.origin||o.originalEvent.origin;if(n!==i||typeof o.data!=="string"){return}var l=o.data;var m={};try{m=JSON.parse(l)}catch(p){return}if(m.hasOwnProperty("eventType")&&typeof m.eventType==="string"){switch(m.eventType){case"omnicheckout:loaded":j({eventType:"omnicheckout:set-purchase-button-interceptor",checkOrderBeforeBooking:true});break;default:if(m.eventType.indexOf("omnicheckout")>-1){if(m.eventType=="omnicheckout:payment-method-change"){if(a){console.log("OmniJS - payment-method-change")}d.paymentMethod=m.method}else{if(m.eventType=="omnicheckout:user-info-change"){if(a){console.log("OmniJS - user-info-change")}d.customerData={address:(typeof m.address!=="undefined"?m.address:{}),delivery:(typeof m.delivery!=="undefined"?m.delivery:{}),ssn:m.ssn,paymentMethod:(typeof d.paymentMethod!=="undefined"?d.paymentMethod:"")}}else{if(m.eventType=="omnicheckout:purchase-failed"){if(typeof e==="function"){e()}else{if(e==="string"){if(typeof window[e]==="function"){window[e]()}}}}else{if(m.eventType=="omnicheckout:puchase-button-clicked"){if(typeof k==="function"){if(a){console.log("OmniJS - puchase-button-clicked event received, user defined callback is used.")}k(d,m)}else{if(typeof k==="string"){if(typeof window[k]==="function"){window[k](d,m)}}else{if(typeof omniBookEvent==="function"){if(a){console.log("puchase-button-clicked event received, default callback is used.")}omniBookEvent(d,m)}else{if(a){console.log("OmniJS - puchase-button-clicked event received and not callbacks was found. Automatically confirming.")}j({eventType:"omnicheckout:order-status",orderReady:true})}}}}}}}}}}},false)}};return f}};