/*!
 * OmniJS v0.03
 *
 * Generic iFrame-driver for Resurs Bank OmniCheckout, for catching events in the Omnicheckout iFrame.
 *
 */
;if(typeof ResursOmni!=="function"&&typeof ResursOmni==="undefined"){function ResursOmni(){var f="";var b="";var j;var c="0.03";var d={paymentMethod:"",customerData:{}};var a=false;if(typeof arguments[0]!=="undefined"){f=arguments[0]}else{f="#omni-checkout-container"}var h="";if(typeof OMNICHECKOUT_IFRAME_URL!=="undefined"){h=OMNICHECKOUT_IFRAME_URL}var g=function(k){if(typeof k==="function"){return true}};var i=function(l){var k;b=document.getElementsByTagName("iframe")[0];k=b.contentWindow||b.contentDocument;if(k&&typeof h==="string"&&h!==""){k.postMessage(JSON.stringify(l),h)}};var e={setBookingCallback:function(k){j=k},setDebug:function(k){if(k==1){k=true}a=k;console.log("OmniJS verbosity level raised")},confirmOrder:function(k){if(typeof k!=="boolean"){k=false}if(a){console.log("OmniJS - Confirm order with boolean: "+k)}i({eventType:"omnicheckout:order-status",orderReady:k})},postFrame:function(k){if(typeof k==="object"){if(a){console.log("OmniJS - Sending message to iframe: "+JSON.stringify(k))}i(k)}},init:function(){window.addEventListener("message",function(n){var m=n.origin||n.originalEvent.origin;if(m!==h||typeof n.data!=="string"){return}var k=n.data;var l={};try{l=JSON.parse(k)}catch(o){return}if(l.hasOwnProperty("eventType")&&typeof l.eventType==="string"){switch(l.eventType){case"omnicheckout:loaded":i({eventType:"omnicheckout:set-purchase-button-interceptor",checkOrderBeforeBooking:true});break;default:if(l.eventType.indexOf("omnicheckout")>-1){if(l.eventType=="omnicheckout:payment-method-change"){if(a){console.log("OmniJS - payment-method-change")}d.paymentMethod=l.method}else{if(l.eventType=="omnicheckout:user-info-change"){if(a){console.log("OmniJS - user-info-change")}d.customerData={address:(typeof l.address!=="undefined"?l.address:{}),delivery:(typeof l.delivery!=="undefined"?l.delivery:{}),ssn:l.ssn,paymentMethod:(typeof d.paymentMethod!=="undefined"?d.paymentMethod:"")}}else{if(l.eventType=="omnicheckout:puchase-button-clicked"){if(typeof j==="function"){if(a){console.log("OmniJS - puchase-button-clicked event received, user defined callback is used.")}j(d,l)}else{if(typeof omniBookEvent==="function"){if(a){console.log("puchase-button-clicked event received, default callback is used.")}omniBookEvent(d,l)}else{if(a){console.log("OmniJS - puchase-button-clicked event received and not callbacks was found. Automatically confirming.")}i({eventType:"omnicheckout:order-status",orderReady:true})}}}}}}}}},false)}};return e}};